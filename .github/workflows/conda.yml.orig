name: Test Conda setup action

on:
  push:
    branches:
    - master
  pull_request:
    branches:
    - master

jobs:
  example-unix:
    name: Example (${{ matrix.os }})
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: ['ubuntu-latest', 'macos-latest']
    steps:
      - uses: goanpeca/action-setup-conda@master
        with:
          conda-version: 4.8
          conda-build-version: 3.17
      - name: Base environment
        shell: bash -l {0}
        run: |
          conda info
          conda list
          printenv | sort
      - run: conda create -n test python=2.7
      - name: Bash check
        shell: bash -l {0}
        run: |
          conda activate test
          conda info
          conda list
          printenv | sort
      - name: Sh check
        shell: sh -l {0}
        run: |
          conda activate test
          conda info
          conda list
          printenv | sort

  example-windows:
    name: Example Windows
    runs-on: 'windows-latest'
    steps:
<<<<<<< HEAD
      - uses: goanpeca/action-setup-conda@master
=======
      - uses: goanpeca/action-setup-conda@test
>>>>>>> Test action
      - name: Base environment
        run: |
          conda info
          conda list
          printenv | sort
      - run: conda create -n test python=2.7
        shell: bash -l {0}
      - name: PowerShell check
        run: |
          conda activate test
          conda info
          conda list
          gci env:* | sort-object name
      - name: PowerShell Core check
        shell: pwsh
        run: |
          conda activate test
          conda info
          conda list
          gci env:* | sort-object name
      - name: Bash check
        shell: bash -l {0}
        run: |
          conda activate test
          conda info
          conda list
          printenv | sort
      - name: Cmd.exe check
        shell: cmd
        run: >-
          "%CONDA_BAT%" activate test &&
          conda info &&
          conda list &&
          SET
